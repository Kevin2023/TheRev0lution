<!DOCTYPE html>
<html>
    <link rel="stylesheet" href="style.css">
    <script type='text/javascript' src='https://api2.scaledrone.com/assets/scaledrone.min.js'></script>
    <script type='text/javascript' src="script.js"></script>
    
<style>

  body, input {
  font-size: 17px;
}

.message {
  margin: 15px 0;
}

.input-area {
  display: flex;
}

.input {
  width: 100%;
  line-height: 40px;
  border: 2px solid #C3C3C3;
  border-radius: 8px;
  padding: 0 15px;
}

.input.name {
  flex-basis: 200px;
  flex-grow: 0;
  margin-right: 5px;
}

.input.content {
  flex-grow: 1;
  margin-right: 5px;
}

.input.button {
  flex-basis: 120px;
  flex-grow: 0;
}








<!--  --><!--  --><!--  --><!--  -->





body {
	background-color: #424242;
	/* background-image: linear-gradient(red, yellow); */
	background-repeat: no-repeat, repeat;
    background-size: 100% 6000%;

}

div[type = "Chat"]{
  /*background-color: DodgerBlue;*/

  border-radius: 5px;
  position: relative;


  width:100%;
  height:200%;
  overflow: auto;
  padding: 25px;


}

#LogInPadding{
  background-color: DodgerBlue;
  padding: 25px;

  border-radius: 5px;
  position: fixed;

  left: 25%;
  bottom: 25%;
  width:50%;
  height:50%;
  box-shadow: 10px 10px;
}
#ShowOnLogin {


}
div[type=Alert]{
  background-color: white;
  box-shadow: -10px 0px yellow;

  color: black;
  
  padding: 20px;
  text-align: center;

  opacity: 0.8;
  filter: alpha(opacity=80); /* For IE8 and earlier */


}
.loginB {
	width:100%;
	border-radius: 25px;
    background-color: white;

}
input[type=password] {
  width: 100%;
  padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}
input[type=submit]{
  width: 100%;
  padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}

#RemoveOnLogIn {

  
  text-align: center;

}

</style>


<body id="body">
	<title>Google Drive</title>



<div id="LogInPadding">
  <h2 id="RemoveOnLogIn"><b> <font face="verdana" color="white">Login:</b></h2> <input type="password"  name="pwd" id="pswrd" id="RemoveOnLogIn" maxlength="18"><br><br>
  <input type="submit" id="RemoveOnLogIn" class="loginB" onclick="login()" value="Login">
  <p id = "attempts"></p>
</div>






  

 <div id="ShowOnLogin">
 
 
 <div type = "Alert">
 <h3>Warning:</h3>
 <p>This site is under construction</p>
 </div>
 <br>
 <br>
 <h3>About:</h3>
 <p>It is also a place where we anonomusly can put our ideas.</p>
 <br>
 <br>
 <h3>Chat:</h3>
 
 
 
 <div type = "Chat">
 	
 	
    <div class="text-area"></div>
    <form class="input-area" onsubmit="onSubmitForm(); return false;">
      <input type="text" class="input name" placeholder="Name..">
      <input type="text" class="input content" placeholder="Message..">
      <input type="submit" class="input button" value="Send">
      
    </form>

    
    
 </div>
 
 
 </div>



<script>
  var Version = "0.0.1";


  var loggedIn = false;
  var passcode = "dGVzdA==";
  var adminCode = "d2luZHlsaWdodDEz";
  var attempts = 3;
  
  
  var userType;
  hideOnLoad();
  function hideOnLoad(){
  
  	//document.getElementById("ShowOnLogin").style.display = "none";
		document.getElementById("ShowOnLogin").hidden=true

  
  }
  function login() {
  	if(attempts > 0){
    	attempts--;
    }
    document.getElementById("attempts").innerHTML = attempts+" attempt(s) left";
    
    var input = document.getElementById("pswrd").value;
    //window.open("www.test.com");
    if(input == atob(passcode) && attempts > 0 || input == atob(adminCode) && attempts > 0){
    
    	if(input == atob(adminCode)){
        	userType = "A";
        }
    	//further verification TODO
    	//alert('Creeper');
		//var person = prompt("Please enter your name", "Harry Potter");

        document.getElementById("pswrd").remove(); 
        document.getElementById("RemoveOnLogIn").remove(); 
		document.getElementById("ShowOnLogin").hidden=false

        			  document.getElementById("ShowOnLogin").style.visibility="visible";
		document.getElementById("LogInPadding").hidden=true;
 document.getElementById("body").style.backgroundSize = "100% 400%";

                      

    }


    //document.getElementById("pswrd").value = "Correct!";
	
	
  }
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  //Chat Stuff
  
  var localName;
    var drone = new ScaleDrone('JOxaLWWctOB0GfdI');

drone.on('open', function (error) {
  if (error) return console.error(error);

  var room = drone.subscribe('Ananimoose');

  room.on('open', function (error) {
    if (error) return console.error(error);
    console.log('Connected to room');
  });

  room.on('data', addMessageToScreen);
});



drone.on('open', function (error) {
  if (error) return console.error(error);

  var room = drone.subscribe('general-chat');

  room.on('open', function (error) {
    if (error) return console.error(error);
    console.log('Connected to room');
  });

  room.on('data', addMessageToScreen);
});




function onSubmitForm(event) {
  var nameEl = document.querySelector('.input.name')
    , contentEl = document.querySelector('.input.content');
	localName = nameEl.value;
  if (nameEl.value && contentEl.value) {
    sendMessageToScaleDrone(nameEl.value, contentEl.value);
    contentEl.value = '';
  }
}

function sendMessageToScaleDrone(name, content) {
  drone.publish({
    room: 'general-chat',
    message: {
      name: btoa(name),
      content: btoa(content)
    }
  });
}
function sendTyping(name) {
//not yet tested
  drone.publish({
    room: 'general-chat',
    message: {
      typingN: btoa(name)
    }
  });
}

function addMessageToScreen(message) {
  var div = document.createElement('div');
  var msgToAdd;
  var VisualName;
  var VisualContent;
  
  

//decrypt  
      VisualName = '<b>' + atob(message.name) + '</b>: ';
    VisualContent = atob(message.content);
    
    
  if(VisualName == '<b>TestBot</b>: ' && userType == "A"){
  
    VisualName = '<i><b>' + 'TestBot' + '</i>  &#129302; </b>: ';

  }else if(userType == "A"){
  	VisualName = '<b>' + atob(message.name) + '&#128296  </b>:';
    //&#128295
  }

   
   
     //EMOJI STUFF
  if(VisualContent.includes(':)')){
    var SwapedMsg = VisualContent.replace(":)", "&#x1F600;");

    VisualContent = SwapedMsg;

  }
  if(VisualContent.includes(':P')){
    var SwapedMsg = VisualContent.replace(":P", "&#128523;");
    VisualContent = SwapedMsg;
  }
  if(VisualContent.includes(':|')){
    var SwapedMsg = VisualContent.replace(":|", "&#128528;");
    VisualContent = SwapedMsg;
  }
  if(VisualContent.includes('-_-')){
    var SwapedMsg = VisualContent.replace("-_-", "&#128529;");
    VisualContent = SwapedMsg;
  }
  if(VisualContent.includes(';)')){
    var SwapedMsg = VisualContent.replace(";)", "&#128521;");
    VisualContent = SwapedMsg;
  }
  if(VisualContent.includes(':fire:')){
    var SwapedMsg = VisualContent.replace(":fire:", "&#128293;");
    VisualContent = SwapedMsg;
  }  
  if(VisualContent.includes(':megaphone:')){
    var SwapedMsg = VisualContent.replace(":megaphone:", "&#128226;");
    VisualContent = SwapedMsg;
  }  
  if(VisualContent.includes(':poop:')){
    var SwapedMsg = VisualContent.replace(":poop:", "&#128169;");
    VisualContent = SwapedMsg;
  }  
  if(VisualContent.includes(':clap:')){
    var SwapedMsg = VisualContent.replace(":clap:", "&#128079;");
    VisualContent = SwapedMsg;
  }  
  if(VisualContent.includes(':thumbs_up:')){
    var SwapedMsg = VisualContent.replace(":thumbs_up:", "&#128077;");
    VisualContent = SwapedMsg;
  }   
  if(VisualContent.includes(':thumbs_down:')){
    var SwapedMsg = VisualContent.replace(":thumbs_down:", "&#128078;");
    VisualContent = SwapedMsg;
  }    
  if(VisualContent.includes(':medal:')){
    var SwapedMsg = VisualContent.replace(":medal:", "&#127941;");
    VisualContent = SwapedMsg;
  }  
  //
  //Commands
  
  if(VisualContent.includes('/ForceReloadAll') && userType == "A"){

	location.reload(true);
	VisualContent = 'Update: reloading';


   }
    
  if(VisualContent.includes('/DM')){
	    if(VisualContent.includes(" "+localName+" ")){
            var removecmd = VisualContent.replace("/DM", "");
            var removename = removecmd.replace(" "+localName+" ", "");

			VisualContent = "DM: "+removename;
			
		}else{
			VisualContent = 'Nothing to see here, this is a new feature. use /DM (name) (MSG)';
        }
   }    
  
  //URLS
  if(message.content.includes('http')){
    var split = message.content.split(" ");
    var ramMsg = '';
    for(var i = 0; i < split.length; i++){
		  if(split[i].includes('http')){
          	ramMsg += ramMsg + '<a href="'+split[i]+'">'+split[i]+'</a>';
          }else{
          	ramMsg += ramMsg + split[i];
          }

    }
    

    VisualContent = ramMsg;
  }   
   
  msgToAdd = VisualName + VisualContent;
  div.innerHTML = msgToAdd;
  div.classList.add('message');
  document.querySelector('.text-area').appendChild(div);
  
  
  //autoScroll to bottom
	window.scrollTo(0, 100000000000);	
}

</script>

</body>
</html>
